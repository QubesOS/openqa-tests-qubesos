#!/usr/share/openqa/script/load_templates
#
# QubesOS Machines, Products, TestSuites and JobTemplates
#
# use load_templates to load the file into the database
#
{
  JobTemplates => [
                    {
                      machine    => { name => "64bit" },
                      prio       => 10,
                      product    => {
                                      arch    => "x86_64",
                                      distri  => "qubesos",
                                      flavor  => "install-iso",
                                      version => "*",
                                    },
                      test_suite => { name => "install_minimal" },
                    },
                    {
                      machine    => { name => "uefi" },
                      prio       => 10,
                      product    => {
                                      arch    => "x86_64",
                                      distri  => "qubesos",
                                      flavor  => "install-iso",
                                      version => "*",
                                    },
                      test_suite => { name => "install_minimal" },
                    },
                    {
                      machine    => { name => "64bit" },
                      prio       => 15,
                      product    => {
                                      arch    => "x86_64",
                                      distri  => "qubesos",
                                      flavor  => "install-iso",
                                      version => "*",
                                    },
                      test_suite => { name => "install_btrfs" },
                    },
                    {
                      machine    => { name => "64bit" },
                      prio       => 10,
                      product    => {
                                      arch    => "x86_64",
                                      distri  => "qubesos",
                                      flavor  => "install-iso",
                                      version => "*",
                                    },
                      test_suite => { name => "install_usbvm_combined" },
                    },
                    {
                      machine    => { name => "64bit" },
                      prio       => 10,
                      product    => {
                                      arch    => "x86_64",
                                      distri  => "qubesos",
                                      flavor  => "install-iso",
                                      version => "*",
                                    },
                      test_suite => { name => "install_no_usbvm" },
                    },
                    {
                      machine    => { name => "64bit" },
                      prio       => 15,
                      product    => {
                                      arch    => "x86_64",
                                      distri  => "qubesos",
                                      flavor  => "install-iso",
                                      version => "*",
                                    },
                      test_suite => { name => "install_over_existing" },
                    },
                    {
                      machine    => { name => "uefi" },
                      prio       => 15,
                      product    => {
                                      arch    => "x86_64",
                                      distri  => "qubesos",
                                      flavor  => "install-iso",
                                      version => "*",
                                    },
                      test_suite => { name => "install_btrfs" },
                    },
                    {
                      machine    => { name => "64bit" },
                      prio       => 20,
                      product    => {
                                      arch    => "x86_64",
                                      distri  => "qubesos",
                                      flavor  => "install-iso",
                                      version => "*",
                                    },
                      test_suite => { name => "install_locale" },
                    },
                    {
                      machine    => { name => "64bit" },
                      prio       => 20,
                      product    => {
                                      arch    => "x86_64",
                                      distri  => "qubesos",
                                      flavor  => "install-iso",
                                      version => "*",
                                    },
                      test_suite => { name => "install_keyboard_layout" },
                    },
                    {
                      machine    => { name => "uefi" },
                      prio       => 20,
                      product    => {
                                      arch    => "x86_64",
                                      distri  => "qubesos",
                                      flavor  => "install-iso",
                                      version => "*",
                                    },
                      test_suite => { name => "install_keyboard_layout" },
                    },
                    {
                      machine    => { name => "mac" },
                      prio       => 40,
                      product    => {
                                      arch    => "x86_64",
                                      distri  => "qubesos",
                                      flavor  => "install-iso",
                                      version => "4.*",
                                    },
                      test_suite => { name => "install_minimal" },
                    },
                    {
                      machine    => { name => "64bit" },
                      prio       => 50,
                      product    => {
                                      arch    => "x86_64",
                                      distri  => "qubesos",
                                      flavor  => "install-iso",
                                      version => "*",
                                    },
                      test_suite => { name => "install_unencrypted_upload" },
                    },
                    {
                      machine    => { name => "uefi" },
                      prio       => 51,
                      product    => {
                                      arch    => "x86_64",
                                      distri  => "qubesos",
                                      flavor  => "install-iso",
                                      version => "*",
                                    },
                      test_suite => { name => "install_unencrypted_upload" },
                    },
		  ],
  Machines     => [
                    {
                      backend   => "qemu",
                      name      => "64bit",
                      settings  => [
                        { key => "QEMUCPU", value => "host,+svm" },
                        { key => "QEMUCPUS", value => "2"},
                        { key => "QEMURAM", value => "6144"},
                        { key => "HDDSIZEGB", value => "40"},
                        { key => "HDDMODEL", value => "scsi-hd"},
                        { key => "NICMODEL", value => "e1000e"},
                        { key => "PART_TABLE_TYPE", value => "mbr"},
                        { key => "VIRTIO_CONSOLE", value => "1"},
                      ],
                    },
                    {
                      backend   => "qemu",
                      name      => "uefi",
                      settings  => [
                        { key => "QEMUCPU", value => "host,+svm" },
                        { key => "QEMUCPUS", value => "2"},
                        { key => "QEMURAM", value => "6144"},
                        { key => "HDDSIZEGB", value => "40"},
                        { key => "HDDMODEL", value => "scsi-hd"},
                        { key => "NICMODEL", value => "e1000e"},
                        { key => "CDMODEL", value => "ide-cd"},
                        { key => "UEFI", value => "1"},
                        { key => "BIOS", value => "/usr/share/qemu/ovmf-x86_64.bin"},
                        { key => "PART_TABLE_TYPE", value => "gpt"},
                        { key => "VIRTIO_CONSOLE", value => "1"},
                      ],
                    },
                    {
                      backend   => "qemu",
                      name      => "mac",
                      settings  => [
                        { key => "QEMUCPU", value => "host,+svm" },
                        { key => "QEMUCPUS", value => "2"},
                        { key => "QEMU_SMBIOS", value => "type=3,manufacturer=apple"},
                        { key => "QEMURAM", value => "6144"},
                        { key => "HDDSIZEGB", value => "40"},
                        { key => "HDDMODEL", value => "scsi-hd"},
                        { key => "NICMODEL", value => "e1000e"},
                        { key => "CDMODEL", value => "ide-cd"},
                        { key => "UEFI", value => "1"},
                        { key => "BIOS", value => "/var/lib/openqa/tests/qubesos/utils/OVMF-mac.fd"},
                        { key => "PART_TABLE_TYPE", value => "gpt"},
                        { key => "VIRTIO_CONSOLE", value => "1"},
                      ],
                    },
                  ],
  Products     => [
                    {
                      arch      => "x86_64",
                      distri    => "qubesos",
                      flavor    => "install-iso",
                      name      => "",
                      settings  => [
                                     { key => "ISO_MAXSIZE", value => 4700372992 },
                                   ],
                      version   => "*",
                    },
                  ],
  TestSuites   => [
                    {
                      name => "install_minimal",
                      settings => [
                        { key => "INSTALL_TEMPLATES", value => "fedora" },
                      ],
                    },
                    {
                      name => "install_over_existing",
                      settings => [
                        { key => "INSTALL_OVER_EXISTING", value => "1" },
                      ],
                    },
                    {
                      name => "install_btrfs",
                      settings => [
                        { key => "PACKAGE_SET", value => "default" },
                        { key => "PARTITIONING", value => "btrfs" },
                      ],
                    },
                    {
                      name => "install_usbvm_combined",
                      settings => [
                        { key => "PACKAGE_SET", value => "default" },
                        { key => "USBVM", value => "sys-net" },
                      ],
                    },
                    {
                      name => "install_no_usbvm",
                      settings => [
                        { key => "PACKAGE_SET", value => "default" },
                        { key => "USBVM", value => "none" },
                      ],
                    },
                    {
                      name => "install_keyboard_layout",
                      settings => [
                        { key => "KEYBOARD_LAYOUT", value => "us-colemak" },
                      ],
                    },
                    {
                      name => "install_locale",
                      settings => [
                        { key => "LOCALE", value => "en_DK.utf8" },
                      ],
                    },
                    {
                      name => "install_default_upload",
                      settings => [
                        { key => "INSTALL_TEMPLATES", value => "all" },
                        { key => "PUBLISH_HDD_1", value => "disk_default_%VERSION%_%MACHINE%.qcow2" },
                      ],
                    },
                    {
                      name => "install_unencrypted_upload",
                      settings => [
                        { key => "INSTALL_TEMPLATES", value => "all" },
                        { key => "PARTITIONING", value => "unencrypted" },
                        { key => "PUBLISH_HDD_1", value => "disk_unencrypted_%VERSION%_%MACHINE%.qcow2" },
                      ],
                    },
                  ],
}
